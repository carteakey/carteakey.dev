{% if strava and strava.length > 0 %}
  {% set cardShell = "rounded-xl border border-gray-200 dark:border-gray-800 bg-gray-100/80 dark:bg-gray-900/70 shadow-sm overflow-hidden transition-shadow duration-200 hover:shadow-lg" %}
  {% set workouts = strava | head(3) %}
  <div class="strava-snippet space-y-4">
    <h3>Recent Workouts</h3>
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {% for activity in workouts %}
        <article class="{{ cardShell }} flex h-full flex-col">
          {% if activity.mapImageUrl %}
            <a
              href="{{ activity.url }}"
              target="_blank"
              rel="noopener noreferrer"
              class="block"
            >
              <img
                src="{{ activity.mapImageUrl }}"
                alt="Map of {{ activity.name }}"
                loading="lazy"
                decoding="async"
                class="h-40 w-full object-cover"
              >
            </a>
          {% endif %}

          <div class="flex h-full flex-col gap-4 p-4 sm:p-5">
            <div class="flex flex-col gap-2">
              <a
                href="{{ activity.url }}"
                target="_blank"
                rel="noopener noreferrer"
                class="inline-flex items-center gap-2 text-sm font-semibold tracking-tight text-gray-900 transition-colors hover:text-amber-600 dark:text-gray-100 dark:hover:text-amber-400"
              >
                {{ activity.name }}
                {% feather "external-link", class="w-4 h-4" %}
              </a>
              <div class="flex flex-wrap items-center gap-2 text-[0.7rem] uppercase tracking-wide text-gray-500 dark:text-gray-400">
                <span class="rounded-full bg-gray-100 px-2 py-1 text-gray-700 dark:bg-gray-800 dark:text-gray-200">{{ activity.type }}</span>
                <time datetime="{{ activity.start_date | htmlDateString }}">{{ activity.start_date | readableDate }}</time>
              </div>
            </div>

            <dl class="grid grid-cols-2 gap-3 text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">
              <div class="flex flex-col gap-1">
                <span>Distance</span>
                <span class="text-sm font-medium text-gray-900 dark:text-gray-100">{{ activity.distance }} miles</span>
              </div>
              <div class="flex flex-col gap-1">
                <span>Moving Time</span>
                <span class="text-sm font-medium text-gray-900 dark:text-gray-100">{{ activity.moving_time }} minutes</span>
              </div>
              {% if activity.elapsed_time %}
                <div class="flex flex-col gap-1">
                  <span>Elapsed</span>
                  <span class="text-sm font-medium text-gray-900 dark:text-gray-100">{{ activity.elapsed_time }} minutes</span>
                </div>
              {% endif %}
              {% if activity.total_elevation_gain %}
                <div class="flex flex-col gap-1">
                  <span>Elevation</span>
                  <span class="text-sm font-medium text-gray-900 dark:text-gray-100">{{ activity.total_elevation_gain }} ft</span>
                </div>
              {% endif %}
            </dl>
          </div>
        </article>
      {% endfor %}
    </div>

    <p class="text-sm text-gray-600 dark:text-gray-300">
      <a href="/workouts" class="accent-link inline-flex items-center gap-1">
        View all recent workouts
        {% feather "arrow-right", class="w-4 h-4" %}
      </a>
    </p>
  </div>
{% endif %}
